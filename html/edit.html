
<style type="text/css">
  <?php include(CMS_MODULE_PATH."/html/table.css")?>
</style>


<h2><center><?php print $grid_name."&nbsp;:&nbsp;".$avatar_edit?></center></h2>
<br />

<form name="assignform" id="assignform" action="<?php print $this->action_url?>" method="POST">

  <input type="hidden" name="course"  value="<?php print $this->course_id?>" />
  <input type="hidden" name="uuid"    value="<?php print $this->UUID?>" />
  <input type="hidden" name="sesskey" value="<?php print sesskey()?>" />

  <table width="450" border="1" bordercolor="#f8f8f8" align="center" cellpadding="2" cellspacing="2" bgcolor="#ffffff">

    <tr>
      <td width="100" class="head"><?php print $firstname_ttl?></td>
      <td width="320" class="even"><b><?php print $this->firstname?></b></td>
    </tr>

    <tr>
      <td class="head"><?php print $lastname_ttl?></td>
      <td class="odd" ><b><?php print $this->lastname?></b></td>
    </tr>

    <tr>
      <td class="head"><?php print $passwd_ttl?></td>
      <?php if (!($this->state&AVATAR_STATE_INACTIVE)) {?>
        <td class="even"><input type="password" name="passwd" size="32" maxlength="16" /></td>
      <?php } else {?>
        <td class="even">&nbsp;</td>
      <?php }?>
    </tr>

    <tr>
      <td class="head"><?php print $confirm_pass_ttl?></td>
      <?php if (!($this->state==AVATAR_STATE_INACTIVE)) {?>
        <td class="odd"><input type="password" name="confirm_pass" size="32" maxlength="16" /></td>
      <?php } else {?>
        <td class="even">&nbsp;</td>
      <?php }?>
    </tr>

    <tr>
      <td class="head"><?php print $home_region_ttl?></td>
      <td class="even">
        <select wide="25" name="hmregion">
          <?php foreach ($this->regionNames as $region) {?>
            <?php if ($region==$this->hmregion) {?>
              <option value="<?php print $region?>" selected><?php print $region?></option>
            <?php } else {?>
              <option value="<?php print $region?>" ><?php print $region?></option>
            <?php }?>
          <?php }?>
		</select>
	  </td>
    </tr>

    <tr>
      <td class="head"><?php print $status_ttl?></td>
      <td class="odd" >
        <input type="radio" name="state" value="<?php print AVATAR_STATE_ACTIVE?>" <?php if (!($this->state&AVATAR_STATE_INACTIVE)) {?>checked<?php }?> /><?php print $active_ttl?>&nbsp;|
        <input type="radio" name="state" value="<?php print AVATAR_STATE_INACTIVE?>" <?php if ($this->state&AVATAR_STATE_INACTIVE) {?>checked<?php }?> /><?php print $inactive_ttl?>
      </td>
    </tr>

    <?php if ($this->use_sloodle) {?>
      <?php if ($this->avatars_num>1 or $this->hasPermit) {?>
        <tr>
          <td class="head"><?php print $sloodle_ttl?></td>
          <td class="even">
            <input name="sloodle" type="checkbox" value="sloodle" <?php if ($this->state&AVATAR_STATE_SLOODLE) {?>checked<?php }?> />&nbsp;<?php print $manage_sloodle?>i
          </td>
        </tr>
      <?php } else {?>
        <input type="hidden" name="sloodle" value="sloodle" />
      <?php }?>
    <?php }?>

    <?php if ($this->hasPermit) {?>
      <tr>
        <td class="head"><?php print $owner_ttl?></td>
        <td class="odd" ><input name="ownername" size="32" maxlength="30" value="<?php print $this->ownername?>" /></td>
      </tr>
    <?php } else {?>
      <tr>
        <td class="head"><?php print $manage_avatar_ttl?></td>
        <td class="even"><input name="nomanage" type="checkbox" value="manage_out" />&nbsp;<?php print $manage_out?></td>
      </tr> 
    <?php }?>

  </table>

  <br />
  <div align="center">
    <input name="submit_update" type="submit" id="submit_update" value="<?php print $update_ttl?>" />&nbsp;
    <input type="reset"  value="<?php print $reset_ttl?>" />
    <?php if ($this->state&AVATAR_STATE_INACTIVE) { ?>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <!--<a href="<?php print $this->delete_url?>" ><font color=#f01010><?php print $delete_ttl?></font></a> -->
      <input name="submit_delete" type="submit" id="submit_delete" value="<?php print $delete_ttl?>" />
    <?php }?>
  </div>

</form>
<br />


<!-- print Message -->
<hr />
<?php if ($this->hasError) {?>
  <div align="center">
    <ul>
      <?php foreach ($this->errorMsg as $mesg) {?>
        <li><font color="#f01010"><b><?php print $mesg?></b></font></li>
      <?php }?>
    </ul>
  </div>

<?php } else {?>
  <?php if ($this->updated_avatar) {?>
    <h3><font color=#1010e0><center><?php print $avatar_updated?></center></font></h3>
    <table width="450" border="1" bordercolor="#f8f8f8" align="center" cellpadding="2" cellspacing="2" bgcolor="#ffffff" >
      <?php if ($this->hasPermit) {?>
        <tr>
          <td width="100" class="head"><?php print $uuid_ttl?></td>
          <td width="320" class="even"><font color="#2060b0"><?php print $this->UUID?></font></td>	
        </tr>
      <?php }?>

      <tr>
        <td width="100" class="head"><?php print $firstname_ttl?></td>
        <td width="320" class="odd" ><?php print $this->firstname?></td>	
      </tr>
      <tr>
        <td class="head"><?php print $lastname_ttl?></td>
        <td class="even"><?php print $this->lastname?></td>	
      </tr>
      <tr>
        <td class="head"><?php print $home_region_ttl?></td>
        <td class="odd" ><?php print $this->hmregion?></td>	
      </tr>
      <tr>
        <td class="head"><?php print $status_ttl?></td>
        <td class="even" >
          <?php if (!($this->state&AVATAR_STATE_SYNCDB)) {?>
            <font color=#cc0000><?php print $not_syncdb_ttl?>
          <?php } elseif ($this->state&AVATAR_STATE_INACTIVE) { ?>
            <font color=#cc0000><?php print $inactive_ttl?>
          <?php } elseif ($this->state&AVATAR_STATE_SYNCDB) {?>
            <font color=#005500><?php print $active_ttl?>
          <?php } else {?>
            <font color=#cc0000><?php print $unknown_status?>
          <?php }?>
          <?php if ($this->state&AVATAR_STATE_SLOODLE and $this->use_sloodle) {?>
            ,&nbsp;<?php print $sloodle_ttl?>
          <?php }?>
            </font>

        </td>
      </tr>
      <?php if ($this->hasPermit or $this->ownername=="") {?>
        <tr>
          <td class="head"><?php print $ownername_ttl ?></td>
          <td class="odd" ><?php print $this->ownername?></td>	
        </tr>
      <?php }?>
    </table>
  <?php }?>
<?php }?>
<br />

